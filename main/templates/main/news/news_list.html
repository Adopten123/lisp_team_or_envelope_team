{% extends 'main/index.html' %}
{% load humanize %}
{% load static %}

{% block extra_styles %}
    <link rel="stylesheet" href="{% static 'css/nl_paginator.css' %}">
{% endblock %}

{% block content %}
    <section class="notifications">
        <h2 class="section-title">Уведомления</h2>

        <div class="notifications-list">
            {% if page_obj.object_list %}
                {% for n in page_obj.object_list %}
                    <article class="notification-item">
                        <div class="notification-icon">{{ n.news_icon }}</div>
                        <div class="notification-content">
                            <p class="notification-text">{{ n.title }}</p>
                            <span class="notification-time"> {{ n.published_at|naturaltime }}
                                {% if n.group %} · для группы {{ n.group.name }}{% endif %}
                            </span>
                        </div>
                    </article>
                {% endfor %}
            {% else %}
                <p>Пока нет новостей.</p>
            {% endif %}
        </div>

        {% if is_paginated %}
            <nav class="paginator" aria-label="Пагинация">
                <!-- Первая -->
                {% if page_obj.has_previous %}
                    <a class="page-btn page-btn--ghost" href="?page=1" aria-disabled="false">« Первая</a>
                {% else %}
                    <span class="page-btn page-btn--ghost is-disabled" aria-disabled="true">« Первая</span>
                {% endif %}

                <!-- Назад -->
                {% if page_obj.has_previous %}
                    <a class="page-btn page-btn--ghost" href="?page={{ page_obj.previous_page_number }}"
                       aria-disabled="false">← Назад</a>
                {% else %}
                    <span class="page-btn page-btn--ghost is-disabled" aria-disabled="true">← Назад</span>
                {% endif %}

                <!-- Эллипс слева -->
                {% if page_obj.number|add:'-2' > 1 %}
                    <a class="page-btn" href="?page=1">1</a>
                    <span class="page-gap" aria-hidden="true">…</span>
                {% endif %}

                <!-- Окно страниц -->
                {% for i in paginator.page_range %}
                    {% if i >= page_obj.number|add:'-2' and i <= page_obj.number|add:'2' %}
                        {% if i == page_obj.number %}
                            <span class="page-btn is-active" aria-current="page">{{ i }}</span>
                        {% else %}
                            <a class="page-btn" href="?page={{ i }}">{{ i }}</a>
                        {% endif %}
                    {% endif %}
                {% endfor %}

                <!-- Эллипс справа -->
                {% if page_obj.number|add:'2' < paginator.num_pages %}
                    <span class="page-gap" aria-hidden="true">…</span>
                    <a class="page-btn" href="?page={{ paginator.num_pages }}">{{ paginator.num_pages }}</a>
                {% endif %}

                <!-- Вперёд -->
                {% if page_obj.has_next %}
                    <a class="page-btn page-btn--ghost" href="?page={{ page_obj.next_page_number }}"
                       aria-disabled="false">Вперёд →</a>
                {% else %}
                    <span class="page-btn page-btn--ghost is-disabled" aria-disabled="true">Вперёд →</span>
                {% endif %}

                <!-- Последняя -->
                {% if page_obj.has_next %}
                    <a class="page-btn page-btn--ghost" href="?page={{ paginator.num_pages }}" aria-disabled="false">Последняя
                        »</a>
                {% else %}
                    <span class="page-btn page-btn--ghost is-disabled" aria-disabled="true">Последняя »</span>
                {% endif %}
            </nav>

        {% endif %}
    </section>
{% endblock %}
